#lang racket

(define morse-map '((".-" . #\a) ("-..." . #\b) ("-.-." . #\c) ("-.." . #\d)
                    (".-" . #\e) ("..-." . #\f) ("--." . #\g) ("...." . #\h)
                    (".." . #\i) (".---" . #\j) ("-.-" . #\k) (".-.." . #\l)
                    ("--" . #\m) ("-." . #\n) ("---" . #\o) (".--." . #\p)
                    ("--.-" . #\q) (".-." . #\r) ("..." . #\s) ("-" . #\t)
                    ("..-" . #\u) ("...-" . #\v) (".--" . #\w) ("-..-" . #\x)
                    ("-.--" . #\y) ("--.." . #\z) (".----" . #\1) ("..---" . #\2)
                    ("...--" . #\3) ("....-" . #\4) ("....." . #\5) ("-...." . #\6)
                    ("--..." . #\7) ("---.." . #\8) ("----." . #\9) ("-----" . #\0)
                    ("" . #\space) ("--..--" . #\,) ("..--.." . #\?) ("-.-.--" . #\!)
                    (".-.-.-" . #\.) ("---..." . #\:) ("-.-.-." . #\;) (".----." . #\')
                    ("-....-" . #\-) ("-..-." . #\/) (".-.-." . #\+) ("-...-" . #\=)
                    (".-..-." . #\") (".--.-." . #\@)))

(define (morse->char m)
  (cdr (assoc m morse-map)))

(define (string-morselist s)
  (map morse->char (string-split s " ")))

(define (morse-decode s)
  (list->string (string-morselist s)))

(morse-decode "-- .--.  ..--- ----- ..--- ..---")
  



















